<form action="/search/restaurants" method="get">
  <input type="text" name="q">
  <button type="submit">Zoek</button>
</form>

<ul id="results"></ul>

<script>
  function status(response) {
    if (response.status >= 200 && response.status < 300) {
      return Promise.resolve(response)
    } else {
      return Promise.reject(new Error(response.statusText))
    }
  }

  function json(response) {
    return response.json()
  }

  function render(data) {
    const $result = $('#results');
    let liArray = [];
    for(let restaurant of data.restaurants) {
      liArray.push(`<li>
        <a href='${restaurant.url}'>${restaurant.name}</a> <br>
        <small><a href="${restaurant.city.url}">${restaurant.city.name}</a></small>
      </li>`);

    }
    $result.html(liArray.join(''));
  }

  $('form').submit(function(e) {
    let search = $(this).find('input').val();

    fetch(`/search/restaurants?q=${search}`)
    .then(status)
    .then(json)
    .then(function(data) {
      render(data);
    }).catch(function(error) {
      console.log('Request failed', error);
    });

    e.preventDefault();
  })
</script>
